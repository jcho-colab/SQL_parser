<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="651pt" height="596pt"
 viewBox="0.00 0.00 651.00 596.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 592)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-592 647,-592 647,4 -4,4"/>
<!-- customer_metrics -->
<g id="node1" class="node">
<title>customer_metrics</title>
<path fill="#e8f5e8" stroke="black" d="M249,-406.5C249,-406.5 159,-406.5 159,-406.5 153,-406.5 147,-400.5 147,-394.5 147,-394.5 147,-302.5 147,-302.5 147,-296.5 153,-290.5 159,-290.5 159,-290.5 249,-290.5 249,-290.5 255,-290.5 261,-296.5 261,-302.5 261,-302.5 261,-394.5 261,-394.5 261,-400.5 255,-406.5 249,-406.5"/>
<text text-anchor="middle" x="204" y="-391.3" font-family="Times,serif" font-size="14.00">customer_metrics</text>
<text text-anchor="middle" x="204" y="-376.3" font-family="Times,serif" font-size="14.00">Type: cte</text>
<text text-anchor="middle" x="204" y="-361.3" font-family="Times,serif" font-size="14.00">Columns:</text>
<text text-anchor="middle" x="204" y="-298.3" font-family="Times,serif" font-size="14.00">... (+3 more)</text>
</g>
<!-- high_value_customers -->
<g id="node3" class="node">
<title>high_value_customers</title>
<path fill="#e8f5e8" stroke="black" d="M434,-406.5C434,-406.5 319,-406.5 319,-406.5 313,-406.5 307,-400.5 307,-394.5 307,-394.5 307,-302.5 307,-302.5 307,-296.5 313,-290.5 319,-290.5 319,-290.5 434,-290.5 434,-290.5 440,-290.5 446,-296.5 446,-302.5 446,-302.5 446,-394.5 446,-394.5 446,-400.5 440,-406.5 434,-406.5"/>
<text text-anchor="middle" x="376.5" y="-391.3" font-family="Times,serif" font-size="14.00">high_value_customers</text>
<text text-anchor="middle" x="376.5" y="-376.3" font-family="Times,serif" font-size="14.00">Type: cte</text>
<text text-anchor="middle" x="376.5" y="-361.3" font-family="Times,serif" font-size="14.00">Columns:</text>
<text text-anchor="middle" x="376.5" y="-298.3" font-family="Times,serif" font-size="14.00">... (+2 more)</text>
</g>
<!-- customer_metrics&#45;&gt;high_value_customers -->
<g id="edge6" class="edge">
<title>customer_metrics&#45;&gt;high_value_customers</title>
<path fill="none" stroke="#388e3c" d="M261.3,-348.5C272.55,-348.5 284.57,-348.5 296.43,-348.5"/>
<polygon fill="#388e3c" stroke="#388e3c" points="296.78,-352 306.78,-348.5 296.78,-345 296.78,-352"/>
</g>
<!-- product_performance -->
<g id="node2" class="node">
<title>product_performance</title>
<path fill="#e8f5e8" stroke="black" d="M259,-162.5C259,-162.5 149,-162.5 149,-162.5 143,-162.5 137,-156.5 137,-150.5 137,-150.5 137,-58.5 137,-58.5 137,-52.5 143,-46.5 149,-46.5 149,-46.5 259,-46.5 259,-46.5 265,-46.5 271,-52.5 271,-58.5 271,-58.5 271,-150.5 271,-150.5 271,-156.5 265,-162.5 259,-162.5"/>
<text text-anchor="middle" x="204" y="-147.3" font-family="Times,serif" font-size="14.00">product_performance</text>
<text text-anchor="middle" x="204" y="-132.3" font-family="Times,serif" font-size="14.00">Type: cte</text>
<text text-anchor="middle" x="204" y="-117.3" font-family="Times,serif" font-size="14.00">Columns:</text>
<text text-anchor="middle" x="204" y="-54.3" font-family="Times,serif" font-size="14.00">... (+3 more)</text>
</g>
<!-- top_products -->
<g id="node4" class="node">
<title>top_products</title>
<path fill="#e8f5e8" stroke="black" d="M408.5,-234.5C408.5,-234.5 344.5,-234.5 344.5,-234.5 338.5,-234.5 332.5,-228.5 332.5,-222.5 332.5,-222.5 332.5,-130.5 332.5,-130.5 332.5,-124.5 338.5,-118.5 344.5,-118.5 344.5,-118.5 408.5,-118.5 408.5,-118.5 414.5,-118.5 420.5,-124.5 420.5,-130.5 420.5,-130.5 420.5,-222.5 420.5,-222.5 420.5,-228.5 414.5,-234.5 408.5,-234.5"/>
<text text-anchor="middle" x="376.5" y="-219.3" font-family="Times,serif" font-size="14.00">top_products</text>
<text text-anchor="middle" x="376.5" y="-204.3" font-family="Times,serif" font-size="14.00">Type: cte</text>
<text text-anchor="middle" x="376.5" y="-189.3" font-family="Times,serif" font-size="14.00">Columns:</text>
<text text-anchor="middle" x="376.5" y="-126.3" font-family="Times,serif" font-size="14.00">... (+3 more)</text>
</g>
<!-- product_performance&#45;&gt;top_products -->
<g id="edge7" class="edge">
<title>product_performance&#45;&gt;top_products</title>
<path fill="none" stroke="#388e3c" d="M271.41,-132.54C288.53,-139.77 306.71,-147.45 323.01,-154.33"/>
<polygon fill="#388e3c" stroke="#388e3c" points="321.79,-157.62 332.37,-158.29 324.52,-151.17 321.79,-157.62"/>
</g>
<!-- customer_product_affinity -->
<g id="node5" class="node">
<title>customer_product_affinity</title>
<path fill="#e8f5e8" stroke="black" d="M631,-277.5C631,-277.5 494,-277.5 494,-277.5 488,-277.5 482,-271.5 482,-265.5 482,-265.5 482,-173.5 482,-173.5 482,-167.5 488,-161.5 494,-161.5 494,-161.5 631,-161.5 631,-161.5 637,-161.5 643,-167.5 643,-173.5 643,-173.5 643,-265.5 643,-265.5 643,-271.5 637,-277.5 631,-277.5"/>
<text text-anchor="middle" x="562.5" y="-262.3" font-family="Times,serif" font-size="14.00">customer_product_affinity</text>
<text text-anchor="middle" x="562.5" y="-247.3" font-family="Times,serif" font-size="14.00">Type: cte</text>
<text text-anchor="middle" x="562.5" y="-232.3" font-family="Times,serif" font-size="14.00">Columns:</text>
<text text-anchor="middle" x="562.5" y="-169.3" font-family="Times,serif" font-size="14.00">... (+4 more)</text>
</g>
<!-- high_value_customers&#45;&gt;customer_product_affinity -->
<g id="edge9" class="edge">
<title>high_value_customers&#45;&gt;customer_product_affinity</title>
<path fill="none" stroke="#388e3c" d="M446.01,-300.47C454.93,-294.21 464.17,-287.74 473.35,-281.3"/>
<polygon fill="#388e3c" stroke="#388e3c" points="475.58,-284.01 481.76,-275.41 471.56,-278.28 475.58,-284.01"/>
</g>
<!-- top_products&#45;&gt;customer_product_affinity -->
<g id="edge12" class="edge">
<title>top_products&#45;&gt;customer_product_affinity</title>
<path fill="none" stroke="#388e3c" d="M420.64,-186.58C436.06,-190.18 454.05,-194.39 471.92,-198.57"/>
<polygon fill="#388e3c" stroke="#388e3c" points="471.28,-202.01 481.82,-200.88 472.88,-195.2 471.28,-202.01"/>
</g>
<!-- customers -->
<g id="node6" class="node">
<title>customers</title>
<path fill="#e3f2fd" stroke="black" d="M79,-375C79,-375 22,-375 22,-375 16,-375 10,-369 10,-363 10,-363 10,-334 10,-334 10,-328 16,-322 22,-322 22,-322 79,-322 79,-322 85,-322 91,-328 91,-334 91,-334 91,-363 91,-363 91,-369 85,-375 79,-375"/>
<text text-anchor="middle" x="50.5" y="-359.8" font-family="Times,serif" font-size="14.00">c</text>
<text text-anchor="middle" x="50.5" y="-344.8" font-family="Times,serif" font-size="14.00">(customers)</text>
<text text-anchor="middle" x="50.5" y="-329.8" font-family="Times,serif" font-size="14.00">Type: table</text>
</g>
<!-- customers&#45;&gt;customer_metrics -->
<g id="edge1" class="edge">
<title>customers&#45;&gt;customer_metrics</title>
<path fill="none" stroke="#388e3c" d="M91.3,-348.5C105.26,-348.5 121.33,-348.5 136.85,-348.5"/>
<polygon fill="#388e3c" stroke="#388e3c" points="136.94,-352 146.94,-348.5 136.94,-345 136.94,-352"/>
</g>
<!-- regions -->
<g id="node7" class="node">
<title>regions</title>
<path fill="#e3f2fd" stroke="black" d="M77,-446C77,-446 24,-446 24,-446 18,-446 12,-440 12,-434 12,-434 12,-405 12,-405 12,-399 18,-393 24,-393 24,-393 77,-393 77,-393 83,-393 89,-399 89,-405 89,-405 89,-434 89,-434 89,-440 83,-446 77,-446"/>
<text text-anchor="middle" x="50.5" y="-430.8" font-family="Times,serif" font-size="14.00">r</text>
<text text-anchor="middle" x="50.5" y="-415.8" font-family="Times,serif" font-size="14.00">(regions)</text>
<text text-anchor="middle" x="50.5" y="-400.8" font-family="Times,serif" font-size="14.00">Type: table</text>
</g>
<!-- orders -->
<g id="node8" class="node">
<title>orders</title>
<path fill="#e3f2fd" stroke="black" d="M77,-289C77,-289 24,-289 24,-289 18,-289 12,-283 12,-277 12,-277 12,-248 12,-248 12,-242 18,-236 24,-236 24,-236 77,-236 77,-236 83,-236 89,-242 89,-248 89,-248 89,-277 89,-277 89,-283 83,-289 77,-289"/>
<text text-anchor="middle" x="50.5" y="-273.8" font-family="Times,serif" font-size="14.00">o</text>
<text text-anchor="middle" x="50.5" y="-258.8" font-family="Times,serif" font-size="14.00">(orders)</text>
<text text-anchor="middle" x="50.5" y="-243.8" font-family="Times,serif" font-size="14.00">Type: table</text>
</g>
<!-- orders&#45;&gt;customer_metrics -->
<g id="edge2" class="edge">
<title>orders&#45;&gt;customer_metrics</title>
<path fill="none" stroke="#388e3c" d="M89.34,-283.98C103.98,-292.29 121.17,-302.05 137.68,-311.42"/>
<polygon fill="#388e3c" stroke="#388e3c" points="136.34,-314.69 146.77,-316.58 139.8,-308.6 136.34,-314.69"/>
</g>
<!-- orders&#45;&gt;product_performance -->
<g id="edge5" class="edge">
<title>orders&#45;&gt;product_performance</title>
<path fill="none" stroke="#388e3c" d="M76.4,-235.66C93.37,-217.46 116.41,-192.9 137,-171.5 137.53,-170.95 138.06,-170.39 138.6,-169.84"/>
<polygon fill="#388e3c" stroke="#388e3c" points="141.24,-172.14 145.68,-162.52 136.21,-167.28 141.24,-172.14"/>
</g>
<!-- orders&#45;&gt;customer_product_affinity -->
<g id="edge10" class="edge">
<title>orders&#45;&gt;customer_product_affinity</title>
<path fill="none" stroke="#388e3c" d="M89.2,-262.64C159.61,-262.48 315.74,-260.07 446,-243.5 454.49,-242.42 463.28,-241.05 472.05,-239.52"/>
<polygon fill="#388e3c" stroke="#388e3c" points="472.72,-242.96 481.93,-237.73 471.47,-236.07 472.72,-242.96"/>
</g>
<!-- order_items -->
<g id="node9" class="node">
<title>order_items</title>
<path fill="#e3f2fd" stroke="black" d="M84,-53C84,-53 17,-53 17,-53 11,-53 5,-47 5,-41 5,-41 5,-12 5,-12 5,-6 11,0 17,0 17,0 84,0 84,0 90,0 96,-6 96,-12 96,-12 96,-41 96,-41 96,-47 90,-53 84,-53"/>
<text text-anchor="middle" x="50.5" y="-37.8" font-family="Times,serif" font-size="14.00">oi</text>
<text text-anchor="middle" x="50.5" y="-22.8" font-family="Times,serif" font-size="14.00">(order_items)</text>
<text text-anchor="middle" x="50.5" y="-7.8" font-family="Times,serif" font-size="14.00">Type: table</text>
</g>
<!-- order_items&#45;&gt;product_performance -->
<g id="edge4" class="edge">
<title>order_items&#45;&gt;product_performance</title>
<path fill="none" stroke="#388e3c" d="M96.14,-49.48C106.09,-54.61 116.91,-60.18 127.73,-65.74"/>
<polygon fill="#388e3c" stroke="#388e3c" points="126.29,-68.94 136.78,-70.41 129.5,-62.72 126.29,-68.94"/>
</g>
<!-- order_items&#45;&gt;customer_product_affinity -->
<g id="edge11" class="edge">
<title>order_items&#45;&gt;customer_product_affinity</title>
<path fill="none" stroke="#388e3c" d="M96.24,-24.34C141.02,-23.21 211.61,-24.21 271,-37.5 353.07,-55.87 375.45,-63.71 446,-109.5 465.34,-122.05 484.31,-138.07 501.12,-153.98"/>
<polygon fill="#388e3c" stroke="#388e3c" points="499.05,-156.84 508.68,-161.26 503.91,-151.8 499.05,-156.84"/>
</g>
<!-- products -->
<g id="node10" class="node">
<title>products</title>
<path fill="#e3f2fd" stroke="black" d="M77,-131C77,-131 24,-131 24,-131 18,-131 12,-125 12,-119 12,-119 12,-90 12,-90 12,-84 18,-78 24,-78 24,-78 77,-78 77,-78 83,-78 89,-84 89,-90 89,-90 89,-119 89,-119 89,-125 83,-131 77,-131"/>
<text text-anchor="middle" x="50.5" y="-115.8" font-family="Times,serif" font-size="14.00">p</text>
<text text-anchor="middle" x="50.5" y="-100.8" font-family="Times,serif" font-size="14.00">(products)</text>
<text text-anchor="middle" x="50.5" y="-85.8" font-family="Times,serif" font-size="14.00">Type: table</text>
</g>
<!-- products&#45;&gt;product_performance -->
<g id="edge3" class="edge">
<title>products&#45;&gt;product_performance</title>
<path fill="none" stroke="#388e3c" d="M89.34,-104.5C100.68,-104.5 113.55,-104.5 126.45,-104.5"/>
<polygon fill="#388e3c" stroke="#388e3c" points="126.77,-108 136.77,-104.5 126.77,-101 126.77,-108"/>
</g>
<!-- categories -->
<g id="node11" class="node">
<title>categories</title>
<path fill="#e3f2fd" stroke="black" d="M232,-234C232,-234 176,-234 176,-234 170,-234 164,-228 164,-222 164,-222 164,-193 164,-193 164,-187 170,-181 176,-181 176,-181 232,-181 232,-181 238,-181 244,-187 244,-193 244,-193 244,-222 244,-222 244,-228 238,-234 232,-234"/>
<text text-anchor="middle" x="204" y="-218.8" font-family="Times,serif" font-size="14.00">cat</text>
<text text-anchor="middle" x="204" y="-203.8" font-family="Times,serif" font-size="14.00">(categories)</text>
<text text-anchor="middle" x="204" y="-188.8" font-family="Times,serif" font-size="14.00">Type: table</text>
</g>
<!-- categories&#45;&gt;top_products -->
<g id="edge8" class="edge">
<title>categories&#45;&gt;top_products</title>
<path fill="none" stroke="#388e3c" d="M244.12,-200.39C267.27,-196.18 296.93,-190.79 322.21,-186.19"/>
<polygon fill="#388e3c" stroke="#388e3c" points="323.16,-189.57 332.38,-184.34 321.91,-182.69 323.16,-189.57"/>
</g>
<!-- subquery_0 -->
<g id="node12" class="node">
<title>subquery_0</title>
<path fill="#fff3e0" stroke="black" d="M89,-517C89,-517 12,-517 12,-517 6,-517 0,-511 0,-505 0,-505 0,-476 0,-476 0,-470 6,-464 12,-464 12,-464 89,-464 89,-464 95,-464 101,-470 101,-476 101,-476 101,-505 101,-505 101,-511 95,-517 89,-517"/>
<text text-anchor="middle" x="50.5" y="-501.8" font-family="Times,serif" font-size="14.00">regional_stats</text>
<text text-anchor="middle" x="50.5" y="-486.8" font-family="Times,serif" font-size="14.00">(subquery_0)</text>
<text text-anchor="middle" x="50.5" y="-471.8" font-family="Times,serif" font-size="14.00">Type: subquery</text>
</g>
<!-- subquery_1 -->
<g id="node13" class="node">
<title>subquery_1</title>
<path fill="#fff3e0" stroke="black" d="M89,-588C89,-588 12,-588 12,-588 6,-588 0,-582 0,-576 0,-576 0,-547 0,-547 0,-541 6,-535 12,-535 12,-535 89,-535 89,-535 95,-535 101,-541 101,-547 101,-547 101,-576 101,-576 101,-582 95,-588 89,-588"/>
<text text-anchor="middle" x="50.5" y="-572.8" font-family="Times,serif" font-size="14.00">seasonal_data</text>
<text text-anchor="middle" x="50.5" y="-557.8" font-family="Times,serif" font-size="14.00">(subquery_1)</text>
<text text-anchor="middle" x="50.5" y="-542.8" font-family="Times,serif" font-size="14.00">Type: subquery</text>
</g>
</g>
</svg>
