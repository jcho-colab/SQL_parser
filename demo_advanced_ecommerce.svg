<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="822pt" height="970pt"
 viewBox="0.00 0.00 822.00 970.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 966)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-966 818,-966 818,4 -4,4"/>
<text text-anchor="middle" x="407" y="-946.8" font-family="Arial" font-size="14.00">SQL Query Diagram</text>
<text text-anchor="middle" x="407" y="-931.8" font-family="Arial" font-size="14.00">Very Complex Complexity | 12 Nodes | 13 Edges</text>
<g id="clust1" class="cluster">
<title>cluster_0</title>
<path fill="#f0f8f0" stroke="darkgreen" stroke-dasharray="5,2" d="M198,-628C198,-628 794,-628 794,-628 800,-628 806,-634 806,-640 806,-640 806,-904 806,-904 806,-910 800,-916 794,-916 794,-916 198,-916 198,-916 192,-916 186,-910 186,-904 186,-904 186,-640 186,-640 186,-634 192,-628 198,-628"/>
<text text-anchor="middle" x="496" y="-903.2" font-family="Arial" font-size="11.00" fill="darkgreen">CTE Level 0</text>
</g>
<!-- customer_base -->
<g id="node1" class="node">
<title>customer_base</title>
<path fill="#e8f5e8" stroke="#388e3c" stroke-width="2" d="M290,-822.5C290,-822.5 206,-822.5 206,-822.5 200,-822.5 194,-816.5 194,-810.5 194,-810.5 194,-749.5 194,-749.5 194,-743.5 200,-737.5 206,-737.5 206,-737.5 290,-737.5 290,-737.5 296,-737.5 302,-743.5 302,-749.5 302,-749.5 302,-810.5 302,-810.5 302,-816.5 296,-822.5 290,-822.5"/>
<text text-anchor="middle" x="248" y="-810.5" font-family="Arial" font-size="10.00">ğŸ”„ customer_base</text>
<text text-anchor="middle" x="248" y="-799.5" font-family="Arial" font-size="10.00">ğŸ“‹ customer_name</text>
<text text-anchor="middle" x="248" y="-788.5" font-family="Arial" font-size="10.00"> &#160;&#160;registration_date</text>
<text text-anchor="middle" x="248" y="-777.5" font-family="Arial" font-size="10.00"> &#160;&#160;region_id</text>
<text text-anchor="middle" x="248" y="-766.5" font-family="Arial" font-size="10.00"> &#160;&#160;customer_tier</text>
<text text-anchor="middle" x="248" y="-755.5" font-family="Arial" font-size="10.00"> &#160;&#160;... (+1)</text>
<text text-anchor="middle" x="248" y="-744.5" font-family="Arial" font-size="10.00">ğŸ”— 1 deps</text>
</g>
<!-- order_metrics -->
<g id="node2" class="node">
<title>order_metrics</title>
<path fill="#e8f5e8" stroke="#388e3c" stroke-width="2" d="M520,-882C520,-882 400,-882 400,-882 394,-882 388,-876 388,-870 388,-870 388,-808 388,-808 388,-802 394,-796 400,-796 400,-796 520,-796 520,-796 526,-796 532,-802 532,-808 532,-808 532,-870 532,-870 532,-876 526,-882 520,-882"/>
<text text-anchor="middle" x="460" y="-869.5" font-family="Arial" font-size="10.00">ğŸ”„ order_metrics</text>
<text text-anchor="middle" x="460" y="-858.5" font-family="Arial" font-size="10.00">ğŸ“‹ last_order_date</text>
<text text-anchor="middle" x="460" y="-847.5" font-family="Arial" font-size="10.00"> &#160;&#160;customer_name</text>
<text text-anchor="middle" x="460" y="-836.5" font-family="Arial" font-size="10.00"> &#160;&#160;avg_order_value</text>
<text text-anchor="middle" x="460" y="-825.5" font-family="Arial" font-size="10.00"> &#160;&#160;total_orders</text>
<text text-anchor="middle" x="460" y="-814.5" font-family="Arial" font-size="10.00"> &#160;&#160;... (+3)</text>
<text text-anchor="middle" x="460" y="-803.5" font-family="Arial" font-size="10.00">ğŸ”— 2 deps</text>
</g>
<!-- customer_base&#45;&gt;order_metrics -->
<g id="edge3" class="edge">
<title>customer_base&#45;&gt;order_metrics</title>
<path fill="none" stroke="#388e3c" d="M302.05,-809.25C302.05,-809.25 379.65,-809.25 379.65,-809.25"/>
<polygon fill="#388e3c" stroke="#388e3c" points="379.65,-812.05 387.65,-809.25 379.65,-806.45 379.65,-812.05"/>
</g>
<!-- product_affinity -->
<g id="node3" class="node">
<title>product_affinity</title>
<path fill="#e8f5e8" stroke="#388e3c" stroke-width="2" d="M786,-744C786,-744 630,-744 630,-744 624,-744 618,-738 618,-732 618,-732 618,-648 618,-648 618,-642 624,-636 630,-636 630,-636 786,-636 786,-636 792,-636 798,-642 798,-648 798,-648 798,-732 798,-732 798,-738 792,-744 786,-744"/>
<text text-anchor="middle" x="708" y="-720.5" font-family="Arial" font-size="10.00">ğŸ”„ product_affinity</text>
<text text-anchor="middle" x="708" y="-709.5" font-family="Arial" font-size="10.00">ğŸ“‹ category_revenue</text>
<text text-anchor="middle" x="708" y="-698.5" font-family="Arial" font-size="10.00"> &#160;&#160;unique_products</text>
<text text-anchor="middle" x="708" y="-687.5" font-family="Arial" font-size="10.00"> &#160;&#160;category_name</text>
<text text-anchor="middle" x="708" y="-676.5" font-family="Arial" font-size="10.00"> &#160;&#160;customer_id</text>
<text text-anchor="middle" x="708" y="-665.5" font-family="Arial" font-size="10.00"> &#160;&#160;... (+1)</text>
<text text-anchor="middle" x="708" y="-654.5" font-family="Arial" font-size="10.00">ğŸ”— 5 deps</text>
</g>
<!-- order_metrics&#45;&gt;product_affinity -->
<g id="edge7" class="edge">
<title>order_metrics&#45;&gt;product_affinity</title>
<path fill="none" stroke="#388e3c" d="M532.11,-829C579.58,-829 633,-829 633,-829 633,-829 633,-752.14 633,-752.14"/>
<polygon fill="#388e3c" stroke="#388e3c" points="635.8,-752.14 633,-744.14 630.2,-752.14 635.8,-752.14"/>
</g>
<!-- customer_segments -->
<g id="node4" class="node">
<title>customer_segments</title>
<path fill="#e8f5e8" stroke="#388e3c" stroke-width="2" d="M756.5,-887.5C756.5,-887.5 659.5,-887.5 659.5,-887.5 653.5,-887.5 647.5,-881.5 647.5,-875.5 647.5,-875.5 647.5,-814.5 647.5,-814.5 647.5,-808.5 653.5,-802.5 659.5,-802.5 659.5,-802.5 756.5,-802.5 756.5,-802.5 762.5,-802.5 768.5,-808.5 768.5,-814.5 768.5,-814.5 768.5,-875.5 768.5,-875.5 768.5,-881.5 762.5,-887.5 756.5,-887.5"/>
<text text-anchor="middle" x="708" y="-875.5" font-family="Arial" font-size="10.00">ğŸ”„ customer_segments</text>
<text text-anchor="middle" x="708" y="-864.5" font-family="Arial" font-size="10.00">ğŸ“‹ computed_segment</text>
<text text-anchor="middle" x="708" y="-853.5" font-family="Arial" font-size="10.00"> &#160;&#160;customer_name</text>
<text text-anchor="middle" x="708" y="-842.5" font-family="Arial" font-size="10.00"> &#160;&#160;avg_order_value</text>
<text text-anchor="middle" x="708" y="-831.5" font-family="Arial" font-size="10.00"> &#160;&#160;total_orders</text>
<text text-anchor="middle" x="708" y="-820.5" font-family="Arial" font-size="10.00"> &#160;&#160;... (+4)</text>
<text text-anchor="middle" x="708" y="-809.5" font-family="Arial" font-size="10.00">ğŸ”— 1 deps</text>
</g>
<!-- order_metrics&#45;&gt;customer_segments -->
<g id="edge9" class="edge">
<title>order_metrics&#45;&gt;customer_segments</title>
<path fill="none" stroke="#388e3c" d="M532.07,-855.5C532.07,-855.5 639.49,-855.5 639.49,-855.5"/>
<polygon fill="#388e3c" stroke="#388e3c" points="639.49,-858.3 647.49,-855.5 639.49,-852.7 639.49,-858.3"/>
</g>
<!-- customers -->
<g id="node5" class="node">
<title>customers</title>
<path fill="#e3f2fd" stroke="#1976d2" stroke-width="2" d="M96,-626C96,-626 12,-626 12,-626 6,-626 0,-620 0,-614 0,-614 0,-566 0,-566 0,-560 6,-554 12,-554 12,-554 96,-554 96,-554 102,-554 108,-560 108,-566 108,-566 108,-614 108,-614 108,-620 102,-626 96,-626"/>
<text text-anchor="middle" x="54" y="-593" font-family="Arial" font-size="10.00">ğŸ“‹ c</text>
<text text-anchor="middle" x="54" y="-582" font-family="Arial" font-size="10.00">(customers)</text>
</g>
<!-- customers&#45;&gt;customer_base -->
<g id="edge1" class="edge">
<title>customers&#45;&gt;customer_base</title>
<path fill="none" stroke="#388e3c" d="M54,-626.18C54,-681.31 54,-780 54,-780 54,-780 185.96,-780 185.96,-780"/>
<polygon fill="#388e3c" stroke="#388e3c" points="185.96,-782.8 193.96,-780 185.96,-777.2 185.96,-782.8"/>
</g>
<!-- subquery_0_0 -->
<g id="node11" class="node">
<title>subquery_0_0</title>
<path fill="#fff3e0" stroke="#f57c00" stroke-width="2" d="M520,-476C520,-476 400,-476 400,-476 394,-476 388,-470 388,-464 388,-464 388,-402 388,-402 388,-396 394,-390 400,-390 400,-390 520,-390 520,-390 526,-390 532,-396 532,-402 532,-402 532,-464 532,-464 532,-470 526,-476 520,-476"/>
<text text-anchor="middle" x="460" y="-458" font-family="Arial" font-size="10.00">ğŸ“Š regional_data</text>
<text text-anchor="middle" x="460" y="-447" font-family="Arial" font-size="10.00">(subquery_0_0)</text>
<text text-anchor="middle" x="460" y="-436" font-family="Arial" font-size="10.00">ğŸ“‹ avg_regional_spend</text>
<text text-anchor="middle" x="460" y="-425" font-family="Arial" font-size="10.00"> &#160;&#160;customer_id</text>
<text text-anchor="middle" x="460" y="-414" font-family="Arial" font-size="10.00"> &#160;&#160;region_name</text>
<text text-anchor="middle" x="460" y="-403" font-family="Arial" font-size="10.00">ğŸ”— 3 deps</text>
</g>
<!-- customers&#45;&gt;subquery_0_0 -->
<g id="edge10" class="edge">
<title>customers&#45;&gt;subquery_0_0</title>
<path fill="none" stroke="#f57c00" stroke-dasharray="5,2" d="M54,-553.98C54,-507.63 54,-433 54,-433 54,-433 379.88,-433 379.88,-433"/>
<polygon fill="#f57c00" stroke="#f57c00" points="379.88,-435.8 387.88,-433 379.88,-430.2 379.88,-435.8"/>
</g>
<!-- regions -->
<g id="node6" class="node">
<title>regions</title>
<path fill="#e3f2fd" stroke="#1976d2" stroke-width="2" d="M290,-372C290,-372 206,-372 206,-372 200,-372 194,-366 194,-360 194,-360 194,-312 194,-312 194,-306 200,-300 206,-300 206,-300 290,-300 290,-300 296,-300 302,-306 302,-312 302,-312 302,-360 302,-360 302,-366 296,-372 290,-372"/>
<text text-anchor="middle" x="248" y="-339" font-family="Arial" font-size="10.00">ğŸ“‹ r</text>
<text text-anchor="middle" x="248" y="-328" font-family="Arial" font-size="10.00">(regions)</text>
</g>
<!-- regions&#45;&gt;subquery_0_0 -->
<g id="edge11" class="edge">
<title>regions&#45;&gt;subquery_0_0</title>
<path fill="none" stroke="#f57c00" stroke-dasharray="5,2" d="M302.21,-352C344.82,-352 397,-352 397,-352 397,-352 397,-381.65 397,-381.65"/>
<polygon fill="#f57c00" stroke="#f57c00" points="394.2,-381.65 397,-389.65 399.8,-381.65 394.2,-381.65"/>
</g>
<!-- orders -->
<g id="node7" class="node">
<title>orders</title>
<path fill="#e3f2fd" stroke="#1976d2" stroke-width="2" d="M290,-620C290,-620 206,-620 206,-620 200,-620 194,-614 194,-608 194,-608 194,-560 194,-560 194,-554 200,-548 206,-548 206,-548 290,-548 290,-548 296,-548 302,-554 302,-560 302,-560 302,-608 302,-608 302,-614 296,-620 290,-620"/>
<text text-anchor="middle" x="248" y="-587" font-family="Arial" font-size="10.00">ğŸ“‹ o</text>
<text text-anchor="middle" x="248" y="-576" font-family="Arial" font-size="10.00">(orders)</text>
</g>
<!-- orders&#45;&gt;order_metrics -->
<g id="edge2" class="edge">
<title>orders&#45;&gt;order_metrics</title>
<path fill="none" stroke="#388e3c" d="M302.37,-601.62C343.87,-601.62 394,-601.62 394,-601.62 394,-601.62 394,-787.74 394,-787.74"/>
<polygon fill="#388e3c" stroke="#388e3c" points="391.2,-787.74 394,-795.74 396.8,-787.74 391.2,-787.74"/>
</g>
<!-- orders&#45;&gt;product_affinity -->
<g id="edge8" class="edge">
<title>orders&#45;&gt;product_affinity</title>
<path fill="none" stroke="#388e3c" d="M248,-620.23C248,-649.81 248,-686.75 248,-686.75 248,-686.75 609.94,-686.75 609.94,-686.75"/>
<polygon fill="#388e3c" stroke="#388e3c" points="609.94,-689.55 617.94,-686.75 609.94,-683.95 609.94,-689.55"/>
</g>
<!-- orders&#45;&gt;subquery_0_0 -->
<g id="edge12" class="edge">
<title>orders&#45;&gt;subquery_0_0</title>
<path fill="none" stroke="#f57c00" stroke-dasharray="5,2" d="M302.02,-565.88C345.71,-565.88 400,-565.88 400,-565.88 400,-565.88 400,-484.14 400,-484.14"/>
<polygon fill="#f57c00" stroke="#f57c00" points="402.8,-484.14 400,-476.14 397.2,-484.14 402.8,-484.14"/>
</g>
<!-- subquery_0_1 -->
<g id="node12" class="node">
<title>subquery_0_1</title>
<path fill="#fff3e0" stroke="#f57c00" stroke-width="2" d="M502,-619.5C502,-619.5 418,-619.5 418,-619.5 412,-619.5 406,-613.5 406,-607.5 406,-607.5 406,-546.5 406,-546.5 406,-540.5 412,-534.5 418,-534.5 418,-534.5 502,-534.5 502,-534.5 508,-534.5 514,-540.5 514,-546.5 514,-546.5 514,-607.5 514,-607.5 514,-613.5 508,-619.5 502,-619.5"/>
<text text-anchor="middle" x="460" y="-607.5" font-family="Arial" font-size="10.00">ğŸ“Š seasonal_trends</text>
<text text-anchor="middle" x="460" y="-596.5" font-family="Arial" font-size="10.00">(subquery_0_1)</text>
<text text-anchor="middle" x="460" y="-585.5" font-family="Arial" font-size="10.00">ğŸ“‹ seasonal_total</text>
<text text-anchor="middle" x="460" y="-574.5" font-family="Arial" font-size="10.00"> &#160;&#160;peak_season</text>
<text text-anchor="middle" x="460" y="-563.5" font-family="Arial" font-size="10.00"> &#160;&#160;customer_id</text>
<text text-anchor="middle" x="460" y="-552.5" font-family="Arial" font-size="10.00"> &#160;&#160;season_rank</text>
<text text-anchor="middle" x="460" y="-541.5" font-family="Arial" font-size="10.00">ğŸ”— 1 deps</text>
</g>
<!-- orders&#45;&gt;subquery_0_1 -->
<g id="edge13" class="edge">
<title>orders&#45;&gt;subquery_0_1</title>
<path fill="none" stroke="#f57c00" stroke-dasharray="5,2" d="M302.05,-583.75C302.05,-583.75 397.69,-583.75 397.69,-583.75"/>
<polygon fill="#f57c00" stroke="#f57c00" points="397.69,-586.55 405.69,-583.75 397.69,-580.95 397.69,-586.55"/>
</g>
<!-- order_items -->
<g id="node8" class="node">
<title>order_items</title>
<path fill="#e3f2fd" stroke="#1976d2" stroke-width="2" d="M502,-332C502,-332 418,-332 418,-332 412,-332 406,-326 406,-320 406,-320 406,-272 406,-272 406,-266 412,-260 418,-260 418,-260 502,-260 502,-260 508,-260 514,-266 514,-272 514,-272 514,-320 514,-320 514,-326 508,-332 502,-332"/>
<text text-anchor="middle" x="460" y="-299" font-family="Arial" font-size="10.00">ğŸ“‹ oi</text>
<text text-anchor="middle" x="460" y="-288" font-family="Arial" font-size="10.00">(order_items)</text>
</g>
<!-- order_items&#45;&gt;product_affinity -->
<g id="edge4" class="edge">
<title>order_items&#45;&gt;product_affinity</title>
<path fill="none" stroke="#388e3c" d="M514.13,-296C574.27,-296 663,-296 663,-296 663,-296 663,-627.63 663,-627.63"/>
<polygon fill="#388e3c" stroke="#388e3c" points="660.2,-627.63 663,-635.63 665.8,-627.63 660.2,-627.63"/>
</g>
<!-- products -->
<g id="node9" class="node">
<title>products</title>
<path fill="#e3f2fd" stroke="#1976d2" stroke-width="2" d="M502,-202C502,-202 418,-202 418,-202 412,-202 406,-196 406,-190 406,-190 406,-142 406,-142 406,-136 412,-130 418,-130 418,-130 502,-130 502,-130 508,-130 514,-136 514,-142 514,-142 514,-190 514,-190 514,-196 508,-202 502,-202"/>
<text text-anchor="middle" x="460" y="-169" font-family="Arial" font-size="10.00">ğŸ“‹ p</text>
<text text-anchor="middle" x="460" y="-158" font-family="Arial" font-size="10.00">(products)</text>
</g>
<!-- products&#45;&gt;product_affinity -->
<g id="edge5" class="edge">
<title>products&#45;&gt;product_affinity</title>
<path fill="none" stroke="#388e3c" d="M514.12,-166C587.09,-166 708,-166 708,-166 708,-166 708,-627.9 708,-627.9"/>
<polygon fill="#388e3c" stroke="#388e3c" points="705.2,-627.9 708,-635.9 710.8,-627.9 705.2,-627.9"/>
</g>
<!-- categories -->
<g id="node10" class="node">
<title>categories</title>
<path fill="#e3f2fd" stroke="#1976d2" stroke-width="2" d="M502,-72C502,-72 418,-72 418,-72 412,-72 406,-66 406,-60 406,-60 406,-12 406,-12 406,-6 412,0 418,0 418,0 502,0 502,0 508,0 514,-6 514,-12 514,-12 514,-60 514,-60 514,-66 508,-72 502,-72"/>
<text text-anchor="middle" x="460" y="-39" font-family="Arial" font-size="10.00">ğŸ“‹ c</text>
<text text-anchor="middle" x="460" y="-28" font-family="Arial" font-size="10.00">(categories)</text>
</g>
<!-- categories&#45;&gt;product_affinity -->
<g id="edge6" class="edge">
<title>categories&#45;&gt;product_affinity</title>
<path fill="none" stroke="#388e3c" d="M514.08,-36C598.74,-36 753,-36 753,-36 753,-36 753,-627.92 753,-627.92"/>
<polygon fill="#388e3c" stroke="#388e3c" points="750.2,-627.92 753,-635.92 755.8,-627.92 750.2,-627.92"/>
</g>
</g>
</svg>
